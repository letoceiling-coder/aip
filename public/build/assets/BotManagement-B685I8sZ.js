import{_ as E,r as f,c as n,a as t,t as a,b as c,d as b,I as N,v as x,o as l,n as G,k as j,x as W,F as V,q as S,h as P,p as L,w as Q,N as H,e as X,f as A,m as Y,l as Z}from"./admin-CFAhs3V1.js";import{a as z,c as U,b as J,d as O}from"./api-BACpyIk9.js";import{S as k}from"./sweetalert2.esm.all-C0u8rGqG.js";const $={name:"ConsultationDetail",props:{consultation:{type:Object,required:!0},botId:{type:[String,Number],required:!0}},emits:["close","updated"],setup(d,{emit:e}){const i=f(!1),o=f({status:d.consultation.status,admin_notes:d.consultation.admin_notes||""});return{form:o,saving:i,saveConsultation:async()=>{i.value=!0;try{const s=await z(`/bot-management/${d.botId}/consultations/${d.consultation.id}`,o.value);if(!s.ok){const r=await s.json().catch(()=>({}));throw new Error(r.message||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")}await k.fire({title:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),e("updated"),e("close")}catch(s){k.fire({title:"–û—à–∏–±–∫–∞",text:s.message||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è",icon:"error",confirmButtonText:"–û–ö"})}finally{i.value=!1}},formatDate:s=>new Date(s).toLocaleString("ru-RU")}}},ee={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},te={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto"},oe={class:"sticky top-0 bg-background border-b border-border p-6"},se={class:"flex items-center justify-between"},re={class:"text-lg font-semibold"},le={class:"p-6 space-y-6"},ne={key:0},de={class:"bg-muted/30 rounded-lg p-4"},ae={class:"text-sm"},ie={key:0,class:"text-sm"},ue={key:1,class:"text-sm"},me={class:"space-y-3"},be={class:"text-sm"},ce={class:"text-sm"},fe={key:0},ge={class:"text-sm whitespace-pre-wrap"},xe={class:"text-sm"},pe={class:"flex gap-2 pt-4 border-t border-border"},ve=["disabled"];function _e(d,e,i,o,m,_){return l(),n("div",ee,[t("div",te,[t("div",oe,[t("div",se,[t("h3",re,"–î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏ #"+a(i.consultation.id),1),t("button",{onClick:e[0]||(e[0]=s=>d.$emit("close")),class:"text-muted-foreground hover:text-foreground"}," ‚úï ")])]),t("div",le,[i.consultation.user?(l(),n("div",ne,[e[5]||(e[5]=t("h4",{class:"text-sm font-medium text-muted-foreground mb-2"},"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",-1)),t("div",de,[t("p",ae,"ID: "+a(i.consultation.user.telegram_user_id),1),i.consultation.user.username?(l(),n("p",ie,"@"+a(i.consultation.user.username),1)):c("",!0),i.consultation.user.first_name?(l(),n("p",ue,a(i.consultation.user.first_name)+" "+a(i.consultation.user.last_name||""),1)):c("",!0)])])):c("",!0),t("div",null,[e[13]||(e[13]=t("h4",{class:"text-sm font-medium text-muted-foreground mb-2"},"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞—è–≤–∫–µ",-1)),t("div",me,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"–ò–º—è",-1)),t("p",be,a(i.consultation.name),1)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"–¢–µ–ª–µ—Ñ–æ–Ω",-1)),t("p",ce,a(i.consultation.phone),1)]),i.consultation.description?(l(),n("div",fe,[e[8]||(e[8]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"–û–ø–∏—Å–∞–Ω–∏–µ",-1)),t("p",ge,a(i.consultation.description),1)])):c("",!0),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"–°—Ç–∞—Ç—É—Å",-1)),b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.status=s),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[...e[9]||(e[9]=[t("option",{value:"new"},"–ù–æ–≤–∞—è",-1),t("option",{value:"in_progress"},"–í —Ä–∞–±–æ—Ç–µ",-1),t("option",{value:"closed"},"–ó–∞–∫—Ä—ã—Ç–∞",-1)])],512),[[N,o.form.status]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",-1)),b(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.admin_notes=s),rows:"4",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none",placeholder:"–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è..."},null,512),[[x,o.form.admin_notes]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è",-1)),t("p",xe,a(o.formatDate(i.consultation.created_at)),1)])])]),t("div",pe,[t("button",{onClick:e[3]||(e[3]=s=>d.$emit("close")),class:"flex-1 h-10 px-4 border border-border bg-background/50 hover:bg-accent/10 rounded-lg"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:e[4]||(e[4]=(...s)=>o.saveConsultation&&o.saveConsultation(...s)),disabled:o.saving,class:"flex-1 h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg disabled:opacity-50"},a(o.saving?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"),9,ve)])])])])}const ye=E($,[["render",_e]]),we={name:"ConsultationTable",components:{ConsultationDetail:ye},props:{botId:{type:[String,Number],required:!0}},setup(d){const e=f(!1),i=f([]),o=f(null),m=f(1),_=f(20),s=f(0),r=f({status:"",date_from:"",date_to:""}),v=async()=>{e.value=!0;try{const C={page:m.value,per_page:_.value,...r.value},T=await U(`/bot-management/${d.botId}/consultations`,C);if(!T.ok)throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫");const g=await T.json();i.value=g.data.consultations||[],s.value=g.data.total||0}catch(C){console.error("Error fetching consultations:",C)}finally{e.value=!1}},h=()=>{r.value={status:"",date_from:"",date_to:""},m.value=1,v()},y=C=>{o.value=C},M=C=>({new:"–ù–æ–≤–∞—è",in_progress:"–í —Ä–∞–±–æ—Ç–µ",closed:"–ó–∞–∫—Ä—ã—Ç–∞"})[C]||C,p=C=>({new:"bg-blue-500/10 text-blue-500",in_progress:"bg-yellow-500/10 text-yellow-500",closed:"bg-green-500/10 text-green-500"})[C]||"bg-gray-500/10 text-gray-500",F=C=>new Date(C).toLocaleDateString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return G(m,()=>{v()}),j(()=>{v()}),{loading:e,consultations:i,selectedConsultation:o,currentPage:m,perPage:_,total:s,filters:r,fetchConsultations:v,resetFilters:h,showDetail:y,getStatusLabel:M,getStatusClass:p,formatDate:F}}},ke={class:"consultation-table space-y-4"},he={class:"bg-muted/30 rounded-lg border border-border p-4"},Ce={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Be={class:"flex items-end"},Ie={key:0,class:"text-center py-12"},Me={key:1,class:"bg-background rounded-lg border border-border overflow-hidden"},Ue={class:"overflow-x-auto"},Ve={class:"w-full"},Se={class:"divide-y divide-border"},Te={class:"px-6 py-4 text-sm"},Ee={class:"px-6 py-4 text-sm"},je={class:"px-6 py-4 text-sm"},Fe={class:"px-6 py-4"},qe={class:"px-6 py-4 text-sm"},De={class:"px-6 py-4 text-right"},Pe=["onClick"],ze={key:0,class:"px-6 py-4 border-t border-border flex items-center justify-between"},Ae={class:"text-sm text-muted-foreground"},Ne={class:"flex gap-2"},Le=["disabled"],Re=["disabled"];function Ge(d,e,i,o,m,_){const s=P("ConsultationDetail");return l(),n("div",ke,[e[16]||(e[16]=t("div",{class:"flex items-center justify-between"},[t("h2",{class:"text-2xl font-semibold"},"–ó–∞—è–≤–∫–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é")],-1)),t("div",he,[t("div",Ce,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium mb-2"},"–°—Ç–∞—Ç—É—Å",-1)),b(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.filters.status=r),onChange:e[1]||(e[1]=(...r)=>o.fetchConsultations&&o.fetchConsultations(...r)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[...e[10]||(e[10]=[t("option",{value:""},"–í—Å–µ",-1),t("option",{value:"new"},"–ù–æ–≤—ã–µ",-1),t("option",{value:"in_progress"},"–í —Ä–∞–±–æ—Ç–µ",-1),t("option",{value:"closed"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)])],544),[[N,o.filters.status]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium mb-2"},"–î–∞—Ç–∞ –æ—Ç",-1)),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.filters.date_from=r),type:"date",onChange:e[3]||(e[3]=(...r)=>o.fetchConsultations&&o.fetchConsultations(...r)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,544),[[x,o.filters.date_from]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium mb-2"},"–î–∞—Ç–∞ –¥–æ",-1)),b(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>o.filters.date_to=r),type:"date",onChange:e[5]||(e[5]=(...r)=>o.fetchConsultations&&o.fetchConsultations(...r)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,544),[[x,o.filters.date_to]])]),t("div",Be,[t("button",{onClick:e[6]||(e[6]=(...r)=>o.resetFilters&&o.resetFilters(...r)),class:"w-full h-10 px-4 border border-border bg-background hover:bg-muted/10 rounded-lg"}," –°–±—Ä–æ—Å–∏—Ç—å ")])])]),o.loading?(l(),n("div",Ie,[...e[14]||(e[14]=[t("p",{class:"text-muted-foreground"},"–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...",-1)])])):c("",!0),o.loading?c("",!0):(l(),n("div",Me,[t("div",Ue,[t("table",Ve,[e[15]||(e[15]=t("thead",{class:"bg-muted/30 border-b border-border"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"ID"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"–ò–º—è"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"–¢–µ–ª–µ—Ñ–æ–Ω"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"–°—Ç–∞—Ç—É—Å"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"–î–∞—Ç–∞"),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase"},"–î–µ–π—Å—Ç–≤–∏—è")])],-1)),t("tbody",Se,[(l(!0),n(V,null,S(o.consultations,r=>(l(),n("tr",{key:r.id,class:"hover:bg-muted/10"},[t("td",Te,a(r.id),1),t("td",Ee,a(r.name),1),t("td",je,a(r.phone),1),t("td",Fe,[t("span",{class:L(["px-2 py-1 text-xs rounded-md",o.getStatusClass(r.status)])},a(o.getStatusLabel(r.status)),3)]),t("td",qe,a(o.formatDate(r.created_at)),1),t("td",De,[t("button",{onClick:v=>o.showDetail(r),class:"px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded"}," –î–µ—Ç–∞–ª–∏ ",8,Pe)])]))),128))])])]),o.total>o.perPage?(l(),n("div",ze,[t("div",Ae," –ü–æ–∫–∞–∑–∞–Ω–æ "+a((o.currentPage-1)*o.perPage+1)+" - "+a(Math.min(o.currentPage*o.perPage,o.total))+" –∏–∑ "+a(o.total),1),t("div",Ne,[t("button",{onClick:e[7]||(e[7]=r=>o.currentPage--),disabled:o.currentPage===1,class:"px-4 py-2 border border-border rounded-lg disabled:opacity-50"}," –ù–∞–∑–∞–¥ ",8,Le),t("button",{onClick:e[8]||(e[8]=r=>o.currentPage++),disabled:o.currentPage*o.perPage>=o.total,class:"px-4 py-2 border border-border rounded-lg disabled:opacity-50"}," –í–ø–µ—Ä–µ–¥ ",8,Re)])])):c("",!0)])),o.selectedConsultation?(l(),W(s,{key:2,consultation:o.selectedConsultation,"bot-id":i.botId,onClose:e[9]||(e[9]=r=>o.selectedConsultation=null),onUpdated:o.fetchConsultations},null,8,["consultation","bot-id","onUpdated"])):c("",!0)])}const Ke=E(we,[["render",Ge]]),Oe={name:"MaterialForm",props:{botId:{type:[String,Number],required:!0},categoryId:{type:[String,Number],default:null},material:{type:Object,default:null}},emits:["close","saved"],setup(d,{emit:e}){const i=f(!1),o=f(!1),m=f(!1),_=f(""),s=f([]),r=f(null),v=f(null),h=f(null),y=f(!!d.material),M=f([]),p=f({title:"",category_id:d.categoryId||null,description:"",file_type:"file",file_url:"",file_id:"",media_id:null,order_index:0,is_active:!0}),F=async()=>{try{const u=await U(`/bot-management/${d.botId}/materials/categories`);if(u.ok){const B=await u.json();M.value=B.data||[]}}catch(u){console.error("Error fetching categories:",u)}},C=async()=>{o.value=!0;try{const u={};_.value&&(u.search=_.value);const B=await U("/media",u);if(B.ok){const D=await B.json();s.value=D.data||[]}}catch(u){console.error("Error fetching media:",u)}finally{o.value=!1}},T=()=>{p.value.file_url="",p.value.file_id="",p.value.media_id=null,r.value=null,v.value=null},g=u=>{const B=u.target.files[0];B&&(r.value=B,p.value.media_id=null,v.value=null)},w=u=>{p.value.media_id=u.id,v.value=u,r.value=null},I=()=>{p.value.media_id&&(m.value=!1)},R=u=>{if(!u)return"0 B";const B=1024,D=["B","KB","MB","GB"],K=Math.floor(Math.log(u)/Math.log(B));return Math.round(u/Math.pow(B,K)*100)/100+" "+D[K]},q=async()=>{i.value=!0;try{const u=new FormData;if(u.append("title",p.value.title),u.append("category_id",p.value.category_id),u.append("description",p.value.description||""),u.append("file_type",p.value.file_type),u.append("order_index",p.value.order_index||0),u.append("is_active",p.value.is_active?1:0),p.value.file_type==="file")if(r.value)u.append("file",r.value);else if(p.value.media_id)u.append("media_id",p.value.media_id);else throw new Error("–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª –∏–ª–∏ —É–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏");else p.value.file_type==="url"?u.append("file_url",p.value.file_url):p.value.file_type==="telegram_file_id"&&u.append("file_id",p.value.file_id);let B;if(y.value?B=await z(`/bot-management/${d.botId}/materials/${d.material.id}`,u):B=await J(`/bot-management/${d.botId}/materials`,u),!B.ok){const D=await B.json().catch(()=>({}));throw new Error(D.message||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞")}await k.fire({title:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),e("saved"),e("close")}catch(u){k.fire({title:"–û—à–∏–±–∫–∞",text:u.message||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞",icon:"error",confirmButtonText:"–û–ö"})}finally{i.value=!1}};return d.material&&(p.value={title:d.material.title||"",category_id:d.material.category_id||d.categoryId||null,description:d.material.description||"",file_type:d.material.file_type||"file",file_url:d.material.file_url||"",file_id:d.material.file_id||"",media_id:d.material.media_id||null,order_index:d.material.order_index||0,is_active:d.material.is_active!==void 0?d.material.is_active:!0},d.material.media&&(v.value=d.material.media)),G(m,u=>{u&&C()}),G(_,()=>{m.value&&C()}),j(()=>{F()}),{saving:i,loadingMedia:o,showMediaPicker:m,mediaSearch:_,mediaFiles:s,selectedFile:r,selectedMedia:v,fileInput:h,isEditMode:y,categories:M,form:p,fetchMediaFiles:C,handleFileTypeChange:T,handleFileSelect:g,selectMedia:w,confirmMediaSelection:I,formatFileSize:R,saveMaterial:q}}},Qe={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},He={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"},Je={class:"sticky top-0 bg-background border-b border-border p-6"},We={class:"flex items-center justify-between"},Xe={class:"text-lg font-semibold"},Ye=["value"],Ze={key:0},$e={class:"space-y-3"},et={key:0,class:"text-xs text-muted-foreground mt-1"},tt={key:0,class:"text-xs text-muted-foreground mt-1"},ot={key:1},st={key:2},rt={class:"flex items-center gap-2"},lt={class:"flex gap-4 pt-4 border-t border-border"},nt=["disabled"],dt={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90 p-4"},at={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col"},it={class:"p-6 border-b border-border"},ut={class:"flex items-center justify-between"},mt={class:"flex-1 overflow-y-auto p-6"},bt={key:0,class:"text-center py-12"},ct={key:1,class:"text-center py-12 text-muted-foreground"},ft={key:2,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},gt=["onClick"],xt={class:"text-sm font-medium truncate"},pt={class:"text-xs text-muted-foreground mt-1"},vt={class:"p-6 border-t border-border"},_t=["disabled"];function yt(d,e,i,o,m,_){return l(),n("div",Qe,[t("div",He,[t("div",Je,[t("div",We,[t("h3",Xe,a(o.isEditMode?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª":"–°–æ–∑–¥–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª"),1),t("button",{onClick:e[0]||(e[0]=s=>d.$emit("close")),class:"text-muted-foreground hover:text-foreground"}," ‚úï ")])]),t("form",{onSubmit:e[13]||(e[13]=Q((...s)=>o.saveMaterial&&o.saveMaterial(...s),["prevent"])),class:"p-6 space-y-6"},[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-2"},"–ù–∞–∑–≤–∞–Ω–∏–µ *",-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.title=s),type:"text",required:"",placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.title]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium mb-2"},"–ö–∞—Ç–µ–≥–æ—Ä–∏—è *",-1)),b(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.category_id=s),required:"",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[e[18]||(e[18]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é",-1)),(l(!0),n(V,null,S(o.categories,s=>(l(),n("option",{key:s.id,value:s.id},a(s.name),9,Ye))),128))],512),[[N,o.form.category_id,void 0,{number:!0}]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium mb-2"},"–û–ø–∏—Å–∞–Ω–∏–µ",-1)),b(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.description=s),rows:"4",placeholder:"–û–ø–∏—Å–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.description]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–∏–ø —Ñ–∞–π–ª–∞ *",-1)),b(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.file_type=s),required:"",onChange:e[5]||(e[5]=(...s)=>o.handleFileTypeChange&&o.handleFileTypeChange(...s)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[...e[21]||(e[21]=[t("option",{value:"file"},"–§–∞–π–ª (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)",-1),t("option",{value:"url"},"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",-1),t("option",{value:"telegram_file_id"},"Telegram file_id",-1)])],544),[[N,o.form.file_type]])]),o.form.file_type==="file"?(l(),n("div",Ze,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium mb-2"},"–§–∞–π–ª",-1)),t("div",$e,[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-xs text-muted-foreground mb-2"}," –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª ",-1)),t("input",{ref:"fileInput",type:"file",onChange:e[6]||(e[6]=(...s)=>o.handleFileSelect&&o.handleFileSelect(...s)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,544),o.selectedFile?(l(),n("p",et," –í—ã–±—Ä–∞–Ω: "+a(o.selectedFile.name),1)):c("",!0)]),e[25]||(e[25]=t("div",{class:"text-center text-sm text-muted-foreground"},"–∏–ª–∏",-1)),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-xs text-muted-foreground mb-2"}," –í—ã–±—Ä–∞—Ç—å –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ",-1)),t("button",{type:"button",onClick:e[7]||(e[7]=s=>o.showMediaPicker=!0),class:"w-full h-10 px-4 border border-border rounded-lg bg-background hover:bg-muted/10"},a(o.form.media_id?"–§–∞–π–ª –≤—ã–±—Ä–∞–Ω":"–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª"),1),o.selectedMedia?(l(),n("p",tt," –í—ã–±—Ä–∞–Ω: "+a(o.selectedMedia.name),1)):c("",!0)])])])):c("",!0),o.form.file_type==="url"?(l(),n("div",ot,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium mb-2"},"URL *",-1)),b(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.form.file_url=s),type:"url",required:"",placeholder:"https://example.com/file.pdf",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.file_url]])])):c("",!0),o.form.file_type==="telegram_file_id"?(l(),n("div",st,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium mb-2"},"Telegram file_id *",-1)),b(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.form.file_id=s),type:"text",required:"",placeholder:"BQACAgIAAxkBAAI...",class:"w-full h-10 px-3 border border-border rounded-lg bg-background font-mono text-sm"},null,512),[[x,o.form.file_id]]),e[29]||(e[29]=t("p",{class:"text-xs text-muted-foreground mt-1"}," –ü–æ–ª—É—á–∏—Ç—å file_id –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏–≤ —Ñ–∞–π–ª –±–æ—Ç—É –∏ –ø—Ä–æ–≤–µ—Ä–∏–≤ –æ—Ç–≤–µ—Ç API ",-1))])):c("",!0),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium mb-2"},"–ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è",-1)),b(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.form.order_index=s),type:"number",min:"0",placeholder:"0",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.order_index,void 0,{number:!0}]])]),t("div",null,[t("label",rt,[b(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.form.is_active=s),type:"checkbox",class:"w-4 h-4"},null,512),[[H,o.form.is_active]]),e[31]||(e[31]=t("span",null,"–ú–∞—Ç–µ—Ä–∏–∞–ª –∞–∫—Ç–∏–≤–µ–Ω",-1))])]),t("div",lt,[t("button",{type:"button",onClick:e[12]||(e[12]=s=>d.$emit("close")),class:"flex-1 h-10 px-4 border border-border bg-background/50 hover:bg-accent/10 rounded-lg"}," –û—Ç–º–µ–Ω–∞ "),t("button",{type:"submit",disabled:o.saving,class:"flex-1 h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg disabled:opacity-50"},a(o.saving?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"),9,nt)])],32),o.showMediaPicker?(l(),n("div",dt,[t("div",at,[t("div",it,[t("div",ut,[e[32]||(e[32]=t("h3",{class:"text-lg font-semibold"},"–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏",-1)),t("button",{onClick:e[14]||(e[14]=s=>o.showMediaPicker=!1),class:"text-muted-foreground hover:text-foreground"}," ‚úï ")]),b(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>o.mediaSearch=s),type:"text",placeholder:"–ü–æ–∏—Å–∫ —Ñ–∞–π–ª–∞...",class:"w-full mt-4 h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.mediaSearch]])]),t("div",mt,[o.loadingMedia?(l(),n("div",bt,[...e[33]||(e[33]=[t("p",{class:"text-muted-foreground"},"–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤...",-1)])])):o.mediaFiles.length===0?(l(),n("div",ct," –§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã ")):(l(),n("div",ft,[(l(!0),n(V,null,S(o.mediaFiles,s=>(l(),n("div",{key:s.id,onClick:r=>o.selectMedia(s),class:L(["p-4 border rounded-lg cursor-pointer transition-colors",o.form.media_id===s.id?"border-accent bg-accent/10":"border-border hover:bg-muted/10"])},[t("div",xt,a(s.name),1),t("div",pt,a(o.formatFileSize(s.size)),1)],10,gt))),128))]))]),t("div",vt,[t("button",{onClick:e[16]||(e[16]=(...s)=>o.confirmMediaSelection&&o.confirmMediaSelection(...s)),disabled:!o.form.media_id,class:"w-full h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg disabled:opacity-50"}," –í—ã–±—Ä–∞—Ç—å ",8,_t)])])])):c("",!0)])])}const wt=E(Oe,[["render",yt]]),kt={name:"MaterialCategoryTree",components:{MaterialForm:wt},props:{botId:{type:[String,Number],required:!0}},setup(d){const e=f(!1),i=f([]),o=f(!1),m=f(!1),_=f(null),s=f(null),r=async()=>{e.value=!0;try{const g=await U(`/bot-management/${d.botId}/materials/categories`);if(!g.ok)throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π");const w=await g.json();i.value=w.data||[];for(const I of i.value)await h(I)}catch(g){console.error("Error fetching categories:",g)}finally{e.value=!1}},v=async()=>{const{value:g}=await k.fire({title:"–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é",html:`
                    <input id="swal-icon" class="swal2-input" placeholder="–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: üß©)" maxlength="10">
                    <input id="swal-name" class="swal2-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
                    <textarea id="swal-description" class="swal2-textarea" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
                    <input id="swal-order" class="swal2-input" type="number" placeholder="–ü–æ—Ä—è–¥–æ–∫" value="0">
                `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"–°–æ–∑–¥–∞—Ç—å",cancelButtonText:"–û—Ç–º–µ–Ω–∞",preConfirm:()=>{const w=document.getElementById("swal-name").value;return w?{name:w,icon:document.getElementById("swal-icon").value||null,description:document.getElementById("swal-description").value,order_index:parseInt(document.getElementById("swal-order").value)||0}:(k.showValidationMessage("–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"),!1)}});if(g)try{if(!(await J(`/bot-management/${d.botId}/materials/categories`,g)).ok)throw new Error("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏");await k.fire({title:"–°–æ–∑–¥–∞–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r(),o.value=!1}catch(w){k.fire({title:"–û—à–∏–±–∫–∞",text:w.message||"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",icon:"error"})}},h=async g=>{try{const w=await U(`/bot-management/${d.botId}/materials`,{category_id:g.id});if(w.ok){const I=await w.json();g.materials=I.data||[]}}catch(w){console.error("Error fetching materials:",w)}},y=async g=>{if((await k.fire({title:"–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?",text:`–ö–∞—Ç–µ–≥–æ—Ä–∏—è "${g.name}" –∏ –≤—Å–µ –µ—ë –º–∞—Ç–µ—Ä–∏–∞–ª—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.`,icon:"warning",showCancelButton:!0,confirmButtonText:"–£–¥–∞–ª–∏—Ç—å",cancelButtonText:"–û—Ç–º–µ–Ω–∞"})).isConfirmed)try{if(!(await O(`/bot-management/${d.botId}/materials/categories/${g.id}`)).ok)throw new Error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏");await k.fire({title:"–£–¥–∞–ª–µ–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r()}catch(I){k.fire({title:"–û—à–∏–±–∫–∞",text:I.message||"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",icon:"error"})}},M=async g=>{if((await k.fire({title:"–£–¥–∞–ª–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª?",text:`–ú–∞—Ç–µ—Ä–∏–∞–ª "${g.title}" –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω.`,icon:"warning",showCancelButton:!0,confirmButtonText:"–£–¥–∞–ª–∏—Ç—å",cancelButtonText:"–û—Ç–º–µ–Ω–∞"})).isConfirmed)try{if(!(await O(`/bot-management/${d.botId}/materials/${g.id}`)).ok)throw new Error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞");await k.fire({title:"–£–¥–∞–ª–µ–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r()}catch(I){k.fire({title:"–û—à–∏–±–∫–∞",text:I.message||"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞",icon:"error"})}},p=async g=>{const{value:w}=await k.fire({title:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é",html:`
                    <input id="swal-icon" class="swal2-input" placeholder="–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: üß©)" value="${g.icon||""}" maxlength="10">
                    <input id="swal-name" class="swal2-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" value="${g.name}">
                    <textarea id="swal-description" class="swal2-textarea" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ">${g.description||""}</textarea>
                    <input id="swal-order" class="swal2-input" type="number" placeholder="–ü–æ—Ä—è–¥–æ–∫" value="${g.order_index}">
                `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",cancelButtonText:"–û—Ç–º–µ–Ω–∞",preConfirm:()=>({name:document.getElementById("swal-name").value,icon:document.getElementById("swal-icon").value||null,description:document.getElementById("swal-description").value,order_index:parseInt(document.getElementById("swal-order").value)||0})});if(w)try{if(!(await z(`/bot-management/${d.botId}/materials/categories/${g.id}`,w)).ok)throw new Error("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏");await k.fire({title:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r()}catch(I){k.fire({title:"–û—à–∏–±–∫–∞",text:I.message||"–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",icon:"error"})}},F=g=>{s.value=g,m.value=!0},C=g=>{_.value=g,s.value=null,m.value=!0},T=async g=>{try{const w=await U("/media",{per_page:100});if(!w.ok)throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–¥–∏–∞-—Ñ–∞–π–ª–æ–≤");const R=(await w.json()).data||[],{value:q}=await k.fire({title:"–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª",html:`
                        <select id="swal-media" class="swal2-select" style="width: 100%; padding: 8px; margin-top: 10px;">
                            <option value="">-- –ë–µ–∑ —Ñ–∞–π–ª–∞ --</option>
                            ${R.map(u=>`<option value="${u.id}" ${g.media_id===u.id?"selected":""}>${u.name} (${(u.size/1024).toFixed(2)} KB)</option>`).join("")}
                        </select>
                    `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",cancelButtonText:"–û—Ç–º–µ–Ω–∞",preConfirm:()=>{const u=document.getElementById("swal-media");return u?u.value:null}});if(q!==void 0){const u=q?parseInt(q):null;if(!(await z(`/bot-management/${d.botId}/materials/categories/${g.id}`,{media_id:u})).ok)throw new Error("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏");await k.fire({title:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r()}}catch(w){k.fire({title:"–û—à–∏–±–∫–∞",text:w.message||"–û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞",icon:"error"})}};return j(()=>{r()}),{loading:e,categories:i,showCategoryModal:o,showMaterialForm:m,selectedCategory:_,selectedMaterial:s,fetchCategories:r,createCategory:v,deleteCategory:y,deleteMaterial:M,editCategory:p,editMaterial:F,showMaterialModal:C,selectCategoryFile:T}}},ht={class:"material-category-tree space-y-4"},Ct={class:"flex items-center justify-between"},Bt={key:0,class:"text-center py-12"},It={key:1,class:"space-y-4"},Mt={class:"flex items-center justify-between mb-4"},Ut={class:"text-lg font-semibold"},Vt={key:0},St={key:0,class:"text-sm text-muted-foreground mt-1"},Tt={key:1,class:"text-xs text-muted-foreground mt-1"},Et={class:"flex gap-2"},jt=["onClick"],Ft=["onClick"],qt=["onClick"],Dt=["onClick"],Pt={key:0,class:"space-y-2"},zt={class:"font-medium"},At={key:0,class:"text-sm text-muted-foreground"},Nt={class:"text-xs text-muted-foreground"},Lt={class:"flex gap-2"},Rt=["onClick"],Gt=["onClick"],Kt={key:1,class:"text-sm text-muted-foreground p-3"},Ot={key:0,class:"text-center py-12 text-muted-foreground"},Qt={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},Ht={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-md"},Jt={class:"p-6"};function Wt(d,e,i,o,m,_){return l(),n("div",ht,[t("div",Ct,[e[3]||(e[3]=t("h2",{class:"text-2xl font-semibold"},"–ú–∞—Ç–µ—Ä–∏–∞–ª—ã",-1)),t("button",{onClick:e[0]||(e[0]=s=>o.showCategoryModal=!0),class:"h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl"}," + –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é ")]),o.loading?(l(),n("div",Bt,[...e[4]||(e[4]=[t("p",{class:"text-muted-foreground"},"–ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤...",-1)])])):c("",!0),o.loading?c("",!0):(l(),n("div",It,[(l(!0),n(V,null,S(o.categories,s=>(l(),n("div",{key:s.id,class:"bg-card rounded-lg border border-border p-4"},[t("div",Mt,[t("div",null,[t("h3",Ut,[s.icon?(l(),n("span",Vt,a(s.icon),1)):c("",!0),X(a(s.name),1)]),s.description?(l(),n("p",St,a(s.description),1)):c("",!0),s.media?(l(),n("p",Tt," üìé –§–∞–π–ª: "+a(s.media.name),1)):c("",!0)]),t("div",Et,[t("button",{onClick:r=>o.editCategory(s),class:"px-3 py-1 text-xs bg-yellow-500 hover:bg-yellow-600 text-white rounded"}," –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ",8,jt),t("button",{onClick:r=>o.selectCategoryFile(s),class:"px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded"}," üìé –§–∞–π–ª ",8,Ft),t("button",{onClick:r=>o.deleteCategory(s),class:"px-3 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded"}," –£–¥–∞–ª–∏—Ç—å ",8,qt),t("button",{onClick:r=>o.showMaterialModal(s),class:"px-3 py-1 text-xs bg-green-500 hover:bg-green-600 text-white rounded"}," + –ú–∞—Ç–µ—Ä–∏–∞–ª ",8,Dt)])]),s.materials&&s.materials.length>0?(l(),n("div",Pt,[(l(!0),n(V,null,S(s.materials,r=>(l(),n("div",{key:r.id,class:"flex items-center justify-between p-3 bg-muted/30 rounded-lg"},[t("div",null,[t("p",zt,a(r.title),1),r.description?(l(),n("p",At,a(r.description),1)):c("",!0),t("p",Nt," –°–∫–∞—á–∏–≤–∞–Ω–∏–π: "+a(r.download_count||0),1)]),t("div",Lt,[t("button",{onClick:v=>o.editMaterial(r),class:"px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded"}," –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ",8,Rt),t("button",{onClick:v=>o.deleteMaterial(r),class:"px-3 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded"}," –£–¥–∞–ª–∏—Ç—å ",8,Gt)])]))),128))])):(l(),n("div",Kt," –ù–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ "))]))),128)),o.categories.length===0?(l(),n("div",Ot," –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é. ")):c("",!0)])),o.showCategoryModal?(l(),n("div",Qt,[t("div",Ht,[t("div",Jt,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold mb-4"},"–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é",-1)),t("button",{onClick:e[1]||(e[1]=(...s)=>o.createCategory&&o.createCategory(...s)),class:"w-full h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg"}," –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è "),t("button",{onClick:e[2]||(e[2]=s=>o.showCategoryModal=!1),class:"w-full mt-2 h-10 px-4 border border-border bg-background/50 hover:bg-accent/10 rounded-lg"}," –û—Ç–º–µ–Ω–∞ ")])])])):c("",!0)])}const Xt=E(kt,[["render",Wt]]),Yt={name:"BotSettingsForm",props:{botId:{type:[String,Number],required:!0}},emits:["updated"],setup(d,{emit:e}){const i=f(!1),o=f(!1),m=f({required_channel_id:null,required_channel_username:"",admin_telegram_ids:[],yandex_maps_url:"",welcome_message:"",other_settings:{phone_validation_strict:!1,max_description_length:1e3,subscription_check_timeout:5}}),_=async()=>{i.value=!0;try{const h=await U(`/bot-management/${d.botId}/settings`);if(!h.ok)throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫");const y=await h.json();if(y.success&&y.data){const M=y.data.settings||{},p=M.messages||{};m.value={required_channel_id:y.data.required_channel_id||null,required_channel_username:y.data.required_channel_username||"",admin_telegram_ids:y.data.admin_telegram_ids||[],yandex_maps_url:y.data.yandex_maps_url||"",welcome_message:y.data.welcome_message||"",messages:{subscription:p.subscription||{required_text:"",subscribe_button:"",check_button:""},consultation:p.consultation||{description:"",form_name_label:"",form_phone_label:"",form_description_label:"",thank_you:"",start_button:"",skip_description_button:""},materials:p.materials||{list_description:"",download_button:"",back_to_list:""},menu:p.menu||{materials_button:"",consultation_button:"",review_button:"",back_to_menu:""},notifications:p.notifications||{consultation_template:""}},other_settings:M.other_settings||{phone_validation_strict:!1,max_description_length:1e3,subscription_check_timeout:5}}}}catch(h){console.error("Error fetching settings:",h)}finally{i.value=!1}},s=async()=>{o.value=!0;try{const h=await z(`/bot-management/${d.botId}/settings`,{required_channel_id:m.value.required_channel_id,required_channel_username:m.value.required_channel_username,admin_telegram_ids:m.value.admin_telegram_ids,yandex_maps_url:m.value.yandex_maps_url,welcome_message:m.value.welcome_message,settings:{messages:m.value.messages,other_settings:m.value.other_settings}});if(!h.ok){const y=await h.json().catch(()=>({}));throw new Error(y.message||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫")}await k.fire({title:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),e("updated")}catch(h){k.fire({title:"–û—à–∏–±–∫–∞",text:h.message||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫",icon:"error",confirmButtonText:"–û–ö"})}finally{o.value=!1}},r=()=>{m.value.admin_telegram_ids.push(null)},v=h=>{m.value.admin_telegram_ids.splice(h,1)};return j(()=>{_()}),{loading:i,saving:o,activeTab,tabs,form:m,fetchSettings:_,saveSettings:s,addAdmin:r,removeAdmin:v}}},Zt={class:"bot-settings-form space-y-6"},$t={class:"border-b border-border"},eo={class:"flex -mb-px"},to=["onClick"],oo={key:0,class:"bg-card rounded-lg border border-border p-6 space-y-4"},so={class:"space-y-2"},ro=["onUpdate:modelValue"],lo=["onClick"],no={key:1,class:"bg-card rounded-lg border border-border p-6 space-y-6"},ao={class:"space-y-4"},io={class:"space-y-4 pt-4 border-t border-border"},uo={class:"space-y-4 pt-4 border-t border-border"},mo={class:"space-y-4 pt-4 border-t border-border"},bo={class:"space-y-4 pt-4 border-t border-border"},co={key:2,class:"bg-card rounded-lg border border-border p-6 space-y-4"},fo={class:"flex items-center gap-2"},go={class:"flex gap-4"},xo=["disabled"];function po(d,e,i,o,m,_){return l(),n("div",Zt,[e[64]||(e[64]=t("h2",{class:"text-2xl font-semibold"},"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞",-1)),t("div",$t,[t("nav",eo,[(l(!0),n(V,null,S(o.tabs,s=>(l(),n("button",{key:s.key,onClick:r=>o.activeTab=s.key,class:L(["px-6 py-4 text-sm font-medium border-b-2 transition-colors",o.activeTab===s.key?"border-accent text-accent":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},a(s.label),11,to))),128))])]),t("form",{onSubmit:e[26]||(e[26]=Q((...s)=>o.saveSettings&&o.saveSettings(...s),["prevent"])),class:"space-y-6"},[o.activeTab==="main"?(l(),n("div",oo,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold"},"–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",-1)),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium mb-2"},"ID –∫–∞–Ω–∞–ª–∞",-1)),b(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.required_channel_id=s),type:"number",placeholder:"-1001234567890",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.required_channel_id,void 0,{number:!0}]]),e[28]||(e[28]=t("p",{class:"text-xs text-muted-foreground mt-1"}," ID –∫–∞–Ω–∞–ª–∞ (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ –±–æ—Ç–∞ @userinfobot) ",-1))]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium mb-2"},"Username –∫–∞–Ω–∞–ª–∞",-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.required_channel_username=s),type:"text",placeholder:"aip_channel",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.required_channel_username]]),e[30]||(e[30]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Username –∫–∞–Ω–∞–ª–∞ –±–µ–∑ —Å–∏–º–≤–æ–ª–∞ @ ",-1))]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium mb-2"},"Telegram ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤",-1)),t("div",so,[(l(!0),n(V,null,S(o.form.admin_telegram_ids,(s,r)=>(l(),n("div",{key:r,class:"flex gap-2"},[b(t("input",{"onUpdate:modelValue":v=>o.form.admin_telegram_ids[r]=v,type:"number",placeholder:"123456789",class:"flex-1 h-10 px-3 border border-border rounded-lg bg-background"},null,8,ro),[[x,o.form.admin_telegram_ids[r],void 0,{number:!0}]]),t("button",{type:"button",onClick:v=>o.removeAdmin(r),class:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg"}," –£–¥–∞–ª–∏—Ç—å ",8,lo)]))),128)),t("button",{type:"button",onClick:e[2]||(e[2]=(...s)=>o.addAdmin&&o.addAdmin(...s)),class:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg"}," + –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ")])]),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium mb-2"},"–°—Å—ã–ª–∫–∞ –Ω–∞ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã",-1)),b(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.yandex_maps_url=s),type:"url",placeholder:"https://yandex.ru/maps/org/...",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.yandex_maps_url]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium mb-2"},"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",-1)),b(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.welcome_message=s),rows:"6",placeholder:"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.welcome_message]])])])):c("",!0),o.activeTab==="messages"?(l(),n("div",no,[e[59]||(e[59]=t("h3",{class:"text-lg font-semibold"},"–¢–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ—Ç–∞",-1)),t("div",ao,[e[38]||(e[38]=t("h4",{class:"text-md font-medium"},"–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª",-1)),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–µ–∫—Å—Ç —ç–∫—Ä–∞–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏",-1)),b(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.form.messages.subscription.required_text=s),rows:"3",placeholder:"–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–µ—Ç–∞-–≤–µ—Ä—Å–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.subscription.required_text]])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏",-1)),b(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.form.messages.subscription.subscribe_button=s),type:"text",placeholder:"üîî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ Telegram",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.subscription.subscribe_button]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏",-1)),b(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.form.messages.subscription.check_button=s),type:"text",placeholder:"‚úÖ –Ø –ø–æ–¥–ø–∏—Å–∞–ª—Å—è",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.subscription.check_button]])])]),t("div",io,[e[46]||(e[46]=t("h4",{class:"text-md font-medium"},"–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è",-1)),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium mb-2"},"–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏",-1)),b(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.form.messages.consultation.description=s),rows:"4",placeholder:"–ï—Å–ª–∏ –≤–∞—à–µ–º—É –±–∏–∑–Ω–µ—Å—É –Ω—É–∂–Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.consultation.description]])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –ø–æ–ª—è "–ò–º—è"',-1)),b(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.form.messages.consultation.form_name_label=s),type:"text",placeholder:"–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.form_name_label]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –ø–æ–ª—è "–¢–µ–ª–µ—Ñ–æ–Ω"',-1)),b(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.form.messages.consultation.form_phone_label=s),type:"text",placeholder:"–í–≤–µ–¥–∏—Ç–µ –≤–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω:",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.form_phone_label]])]),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –ø–æ–ª—è "–û–ø–∏—Å–∞–Ω–∏–µ"',-1)),b(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.form.messages.consultation.form_description_label=s),type:"text",placeholder:"–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ...):",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.form_description_label]])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium mb-2"},"–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏",-1)),b(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>o.form.messages.consultation.thank_you=s),rows:"2",placeholder:"–°–ø–∞—Å–∏–±–æ. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.consultation.thank_you]])]),t("div",null,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è"',-1)),b(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>o.form.messages.consultation.start_button=s),type:"text",placeholder:"üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.start_button]])]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"',-1)),b(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>o.form.messages.consultation.skip_description_button=s),type:"text",placeholder:"–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.skip_description_button]])])]),t("div",uo,[e[50]||(e[50]=t("h4",{class:"text-md font-medium"},"–ú–∞—Ç–µ—Ä–∏–∞–ª—ã",-1)),t("div",null,[e[47]||(e[47]=t("label",{class:"block text-sm font-medium mb-2"},"–û–ø–∏—Å–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤",-1)),b(t("textarea",{"onUpdate:modelValue":e[15]||(e[15]=s=>o.form.messages.materials.list_description=s),rows:"3",placeholder:"–ú—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.materials.list_description]])]),t("div",null,[e[48]||(e[48]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è",-1)),b(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>o.form.messages.materials.download_button=s),type:"text",placeholder:"‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.materials.download_button]])]),t("div",null,[e[49]||(e[49]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"',-1)),b(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>o.form.messages.materials.back_to_list=s),type:"text",placeholder:"‚¨ÖÔ∏è –ù–∞–∑–∞–¥",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.materials.back_to_list]])])]),t("div",mo,[e[55]||(e[55]=t("h4",{class:"text-md font-medium"},"–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",-1)),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–ú–∞—Ç–µ—Ä–∏–∞–ª—ã"',-1)),b(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>o.form.messages.menu.materials_button=s),type:"text",placeholder:"üìÇ –ü–æ–ª–µ–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –¥–æ–≥–æ–≤–æ—Ä—ã",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.materials_button]])]),t("div",null,[e[52]||(e[52]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è"',-1)),b(t("input",{"onUpdate:modelValue":e[19]||(e[19]=s=>o.form.messages.menu.consultation_button=s),type:"text",placeholder:"üìû –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.consultation_button]])]),t("div",null,[e[53]||(e[53]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–û—Ç–∑—ã–≤"',-1)),b(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>o.form.messages.menu.review_button=s),type:"text",placeholder:"‚≠ê –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –Ω–∞ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç–∞—Ö",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.review_button]])]),t("div",null,[e[54]||(e[54]=t("label",{class:"block text-sm font-medium mb-2"},'–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"',-1)),b(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>o.form.messages.menu.back_to_menu=s),type:"text",placeholder:"‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.back_to_menu]])])]),t("div",bo,[e[58]||(e[58]=t("h4",{class:"text-md font-medium"},"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º",-1)),t("div",null,[e[56]||(e[56]=t("label",{class:"block text-sm font-medium mb-2"},"–®–∞–±–ª–æ–Ω —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–µ",-1)),b(t("textarea",{"onUpdate:modelValue":e[22]||(e[22]=s=>o.form.messages.notifications.consultation_template=s),rows:"6",placeholder:`–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é

–ò–º—è: {name}
–¢–µ–ª–µ—Ñ–æ–Ω: {phone}
–û–ø–∏—Å–∞–Ω–∏–µ: {description}
–î–∞—Ç–∞: {date}`,class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none font-mono text-sm"},null,512),[[x,o.form.messages.notifications.consultation_template]]),e[57]||(e[57]=t("p",{class:"text-xs text-muted-foreground mt-1"}," –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: {name}, {phone}, {description}, {date} ",-1))])])])):c("",!0),o.activeTab==="advanced"?(l(),n("div",co,[e[63]||(e[63]=t("h3",{class:"text-lg font-semibold"},"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",-1)),t("div",null,[t("label",fo,[b(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>o.form.other_settings.phone_validation_strict=s),type:"checkbox",class:"w-4 h-4"},null,512),[[H,o.form.other_settings.phone_validation_strict]]),e[60]||(e[60]=t("span",null,"–°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞",-1))])]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium mb-2"},"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ–ø–∏—Å–∞–Ω–∏—è",-1)),b(t("input",{"onUpdate:modelValue":e[24]||(e[24]=s=>o.form.other_settings.max_description_length=s),type:"number",min:"10",max:"5000",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.other_settings.max_description_length,void 0,{number:!0}]])]),t("div",null,[e[62]||(e[62]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–∞–π–º–∞—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏ (—Å–µ–∫)",-1)),b(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>o.form.other_settings.subscription_check_timeout=s),type:"number",min:"1",max:"30",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.other_settings.subscription_check_timeout,void 0,{number:!0}]])])])):c("",!0),t("div",go,[t("button",{type:"submit",disabled:o.saving,class:"flex-1 h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl disabled:opacity-50"},a(o.saving?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"),9,xo)])],32)])}const vo=E(Yt,[["render",po]]),_o={name:"BotStatistics",props:{botId:{type:[String,Number],required:!0}},setup(d){const e=f(!1),i=f(null),o=async()=>{e.value=!0;try{const m=await U(`/bot-management/${d.botId}/statistics`);if(!m.ok)throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏");const _=await m.json();_.success&&_.data&&(i.value=_.data)}catch(m){console.error("Error fetching statistics:",m)}finally{e.value=!1}};return j(()=>{o()}),{loading:e,statistics:i}}},yo={class:"bot-statistics space-y-6"},wo={key:0,class:"text-center py-12"},ko={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ho={class:"bg-card rounded-lg border border-border p-6"},Co={class:"text-3xl font-semibold"},Bo={class:"bg-card rounded-lg border border-border p-6"},Io={class:"text-3xl font-semibold"},Mo={class:"bg-card rounded-lg border border-border p-6"},Uo={class:"text-3xl font-semibold"},Vo={class:"bg-card rounded-lg border border-border p-6"},So={class:"text-3xl font-semibold"},To={key:2,class:"bg-card rounded-lg border border-border p-6"},Eo={class:"grid grid-cols-3 gap-4"},jo={class:"text-2xl font-semibold"},Fo={class:"text-2xl font-semibold"},qo={class:"text-2xl font-semibold"},Do={key:3,class:"bg-card rounded-lg border border-border p-6"},Po={class:"space-y-2"},zo={class:"font-medium"},Ao={class:"text-sm text-muted-foreground"};function No(d,e,i,o,m,_){return l(),n("div",yo,[e[10]||(e[10]=t("h2",{class:"text-2xl font-semibold"},"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",-1)),o.loading?(l(),n("div",wo,[...e[0]||(e[0]=[t("p",{class:"text-muted-foreground"},"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...",-1)])])):c("",!0),!o.loading&&o.statistics?(l(),n("div",ko,[t("div",ho,[e[1]||(e[1]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",-1)),t("p",Co,a(o.statistics.total_users||0),1)]),t("div",Bo,[e[2]||(e[2]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞ 30 –¥–Ω–µ–π",-1)),t("p",Io,a(o.statistics.active_users_30d||0),1)]),t("div",Mo,[e[3]||(e[3]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫",-1)),t("p",Uo,a(o.statistics.total_consultations||0),1)]),t("div",Vo,[e[4]||(e[4]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"–°–∫–∞—á–∏–≤–∞–Ω–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤",-1)),t("p",So,a(o.statistics.materials_downloads||0),1)])])):c("",!0),!o.loading&&o.statistics?(l(),n("div",To,[e[8]||(e[8]=t("h3",{class:"text-lg font-semibold mb-4"},"–ó–∞—è–≤–∫–∏ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º",-1)),t("div",Eo,[t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-muted-foreground"},"–ù–æ–≤—ã–µ",-1)),t("p",jo,a(o.statistics.consultations_by_status?.new||0),1)]),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-muted-foreground"},"–í —Ä–∞–±–æ—Ç–µ",-1)),t("p",Fo,a(o.statistics.consultations_by_status?.in_progress||0),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-muted-foreground"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),t("p",qo,a(o.statistics.consultations_by_status?.closed||0),1)])])])):c("",!0),!o.loading&&o.statistics&&o.statistics.popular_materials?.length>0?(l(),n("div",Do,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold mb-4"},"–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",-1)),t("div",Po,[(l(!0),n(V,null,S(o.statistics.popular_materials,s=>(l(),n("div",{key:s.id,class:"flex items-center justify-between p-3 bg-muted/30 rounded-lg"},[t("p",zo,a(s.title),1),t("p",Ao,a(s.download_count||0)+" —Å–∫–∞—á–∏–≤–∞–Ω–∏–π",1)]))),128))])])):c("",!0)])}const Lo=E(_o,[["render",No]]),Ro={name:"BotManagement",components:{ConsultationTable:Ke,MaterialCategoryTree:Xt,BotSettingsForm:vo,BotStatistics:Lo},setup(){const d=Z(),e=Y(()=>d.params.botId),i=f(!1),o=f(null),m=f(null),_=f("consultations"),s=[{key:"consultations",label:"–ó–∞—è–≤–∫–∏"},{key:"materials",label:"–ú–∞—Ç–µ—Ä–∏–∞–ª—ã"},{key:"settings",label:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"},{key:"statistics",label:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"}],r=async()=>{i.value=!0,o.value=null;try{const v=await U(`/bots/${e.value}`);if(!v.ok){const y=await v.json().catch(()=>({}));throw new Error(y.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–æ—Ç–∞")}const h=await v.json();m.value=h.data||null}catch(v){o.value=v.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–æ—Ç–∞"}finally{i.value=!1}};return j(()=>{r()}),{botId:e,loading:i,error:o,bot:m,activeTab:_,tabs:s,fetchBot:r}}},Go={class:"bot-management-page space-y-6"},Ko={class:"flex items-center justify-between"},Oo={key:0,class:"text-muted-foreground mt-1"},Qo={key:0,class:"flex items-center justify-center py-12"},Ho={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},Jo={class:"text-destructive"},Wo={key:2,class:"bg-card rounded-lg border border-border"},Xo={class:"border-b border-border"},Yo={class:"flex -mb-px"},Zo=["onClick"],$o={class:"p-6"},es={key:0},ts={key:1},os={key:2},ss={key:3};function rs(d,e,i,o,m,_){const s=P("ConsultationTable"),r=P("MaterialCategoryTree"),v=P("BotSettingsForm"),h=P("BotStatistics");return l(),n("div",Go,[t("div",Ko,[t("div",null,[e[1]||(e[1]=t("h1",{class:"text-3xl font-semibold text-foreground"},"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º",-1)),o.bot?(l(),n("p",Oo,a(o.bot.name),1)):c("",!0)]),t("button",{onClick:e[0]||(e[0]=y=>d.$router.push({name:"admin.bots"})),class:"h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl shadow-lg shadow-accent/10 inline-flex items-center justify-center gap-2"}," ‚Üê –ù–∞–∑–∞–¥ –∫ –±–æ—Ç–∞–º ")]),o.loading?(l(),n("div",Qo,[...e[2]||(e[2]=[t("p",{class:"text-muted-foreground"},"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",-1)])])):c("",!0),o.error?(l(),n("div",Ho,[t("p",Jo,a(o.error),1)])):c("",!0),!o.loading&&o.bot?(l(),n("div",Wo,[t("div",Xo,[t("nav",Yo,[(l(!0),n(V,null,S(o.tabs,y=>(l(),n("button",{key:y.key,onClick:M=>o.activeTab=y.key,class:L(["px-6 py-4 text-sm font-medium border-b-2 transition-colors",o.activeTab===y.key?"border-accent text-accent":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},a(y.label),11,Zo))),128))])]),t("div",$o,[o.activeTab==="consultations"?(l(),n("div",es,[A(s,{"bot-id":o.botId},null,8,["bot-id"])])):c("",!0),o.activeTab==="materials"?(l(),n("div",ts,[A(r,{"bot-id":o.botId},null,8,["bot-id"])])):c("",!0),o.activeTab==="settings"?(l(),n("div",os,[A(v,{"bot-id":o.botId,onUpdated:o.fetchBot},null,8,["bot-id","onUpdated"])])):c("",!0),o.activeTab==="statistics"?(l(),n("div",ss,[A(h,{"bot-id":o.botId},null,8,["bot-id"])])):c("",!0)])])):c("",!0)])}const as=E(Ro,[["render",rs]]);export{as as default};
